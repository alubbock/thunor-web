{% extends "base.html" %}

{% block title %}Plots{% endblock %}

{% block titlerow %}
<div class="row">
    <div id="plot-toolbar" class="col-lg-12" role="toolbar" aria-label="Plot
    toolbar">

        <div id="hts-num-cols-lg">
            <label>Layout</label>
            <div class="btn-group">

              <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <span id="hts-current-num-cols-lg">1 column</span>
                <span class="caret"></span>
              </button>
              <ul class="dropdown-menu">
                <li data-cols="1"><a href="#">1 column</a></li>
                <li data-cols="2"><a href="#">2 columns</a></li>
                <li data-cols="3"><a href="#">3 columns</a></li>
                <li data-cols="4"><a href="#">4 columns</a></li>
              </ul>
            </div>
        </div>

        <div id="hts-num-cols-md">
            <label>Layout</label>
          <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <span id="hts-current-num-cols-md">1 column</span>
            <span class="caret"></span>
          </button>
          <ul class="dropdown-menu">
            <li data-cols="1"><a href="#">1 column</a></li>
            <li data-cols="2"><a href="#">2 columns</a></li>
          </ul>
        </div>

        <label>Plots</label>
        <div class="btn-group">
            <button type="button" class="btn btn-default" data-keyboard="true"
                    data-toggle="modal"
                    data-target="#change-dataset-modal">
                <i class="fa fa-database"></i> <span id="dataset-name">{{ dataset.name }}</span>
            </button>
            <button class="btn btn-success new-plot-btn"
                    data-dataset-id="{{ dataset.id }}"><i class="glyphicon
                    glyphicon-plus"></i> Add plot</button>
        </div>
    </div>
</div>
{% endblock %}

{% block content %}
<div class="row sortable-panels">
{#    {% for graph in graphs %}#}

{#    {% endfor %}#}
</div>

<div class="plot-panel panel-container col-lg-12 col-md-12">
    <div class="panel panel-default">
        <div class="panel-heading">
            <i class="glyphicon glyphicon-th"></i>

            <span class="pull-right panel-close-btn"
                  title="Close plot"
                  data-effect="fadeOut">
                <i class="fa fa-times"></i>
            </span>

            <div class="btn-group">
              <button type="button" class="hts-change-data-btn btn
              btn-default dropdown-toggle" aria-haspopup="true">
                <span class="fa fa-exchange"></span>
                <span>Change Plot</span>
                <span class="caret"></span>
              </button>

              <button type="button" class="btn btn-default panel-copy-btn">
                <span><i class="fa fa-clone"></i> Duplicate</span>
              </button>
            </div>

        </div>
        <div class="panel-body">

                    <div class="hts-change-data container" data-loaded="false">
<form>
<div class="row">
    <div class="col-sm-12">
        <div class="form-group">
            <label for="hts-plot-type">Plot Type</label>
            <div class="hts-plot-type btn-group btn-group-3
            btn-group-responsive" data-toggle="buttons">
              <label class="btn btn-primary active">
                  <input type="radio" name="plotType" value="tc"
                         autocomplete="off" checked><span>Time Course</span>
              </label>
              <label class="btn btn-primary">
                  <input type="radio" name="plotType" value="dip"
                         autocomplete="off"><span>Dose Response</span>
              </label>
              <label class="btn btn-primary">
                  <input type="radio" name="plotType" value="dippar"
                         autocomplete="off"><span>Dose Response
                      Parameters</span>
              </label>
            </div>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-sm-6">
    <input type="hidden" name="datasetId">
    <div class="form-group">
        <label for="hts-change-cell-line">Cell Line</label>
        <select multiple data-live-search="true" name="cellLineId"
                class="hts-change-cell-line form-control" title="Loading...">
        </select>
    </div>
    <div class="form-group">
        <label for="hts-change-drug">Drug</label>
        <select multiple data-live-search="true" name="drugId"
        class="hts-change-drug form-control" title="Loading...">
        </select>
    </div>
    <div class="form-group" style="display:none">
        <label for="hts-change-assay">Assay</label>
        <select name="assayId" class="hts-change-assay form-control"
                title="Loading..." disabled>
        </select>
    </div>
    </div>
    <div class="col-sm-6">
{#    <div class="form-group" style="display:none">#}
{#        <label for="hts-change-control">Control</label>#}
{#        <select name="controlId" class="hts-change-control form-control">#}
{#        </select>#}
{#    </div>#}
    <div class="form-group" style="display:none">
        <label for="hts-error-bars">Error Bars</label>
        <div class="hts-error-bars btn-group btn-group-3 btn-group-responsive"
             data-toggle="buttons">
          <label class="btn btn-default active">
            <input type="radio" name="errorBars" value="None"
                   autocomplete="off" checked disabled> None
          </label>
          <label class="btn btn-default">
            <input type="radio" name="errorBars" value="sd"
                   autocomplete="off" disabled> Std. Dev.
          </label>
          <label class="btn btn-default">
            <input type="radio" name="errorBars" value="range"
                   autocomplete="off" disabled> Range
          </label>
        </div>
    </div>
    <div class="form-group" style="display:none">
        <label for="hts-dippar-sort">Sort By</label>
        <div class="hts-dippar-sort btn-group btn-group-5 btn-group-responsive"
             data-toggle="buttons">
          <label class="btn btn-default active">
            <input type="radio" name="dipParSort" value="ic50"
                   autocomplete="off" checked disabled> IC50
          </label>
          <label class="btn btn-default">
            <input type="radio" name="dipParSort" value="ec50"
                   autocomplete="off" disabled> EC50
          </label>
          <label class="btn btn-default">
            <input type="radio" name="dipParSort" value="emax"
                   autocomplete="off" disabled> Emax
          </label>
          <label class="btn btn-default">
            <input type="radio" name="dipParSort" value="hill"
                   autocomplete="off" disabled> Hill
          </label>
          <label class="btn btn-default">
            <input type="radio" name="dipParSort" value="aa"
                   autocomplete="off" disabled> AA
          </label>
        </div>
    </div>
    <div class="form-group" style="display:none">
        <label for="hts-dose-input-group">Maximum dose</label>
        {% with editable=True default_dose_base="1" default_dose_multiplier="1e-3" default_dose_multiplier_label="mM" %}
        {% include "dose_input.html" %}
        {% endwith %}
    </div>
    <div class="form-group">
        <label for="hts-log-transform">Vertical axis</label>
        <div class="hts-log-transform btn-group btn-group-2 btn-group-responsive"
             data-toggle="buttons">
          <label class="btn btn-default active">
            <input type="radio" name="logTransform" value="log2"
                   autocomplete="off" checked> Doublings (log2)
          </label>
          <label class="btn btn-default">
            <input type="radio" name="logTransform" value="None"
                   autocomplete="off"> Linear
          </label>
        </div>
    </div>
    <div class="form-group">
        <label for="hts-show-dip-fit">Overlay Dip Fit</label>
        <div class="hts-show-dip-fit btn-group btn-group-2
        btn-group-responsive"
             data-toggle="buttons">
          <label class="btn btn-default active">
            <input type="radio" name="overlayDipFit" value="false"
                   autocomplete="off" checked> Off
          </label>
          <label class="btn btn-default">
            <input type="radio" name="overlayDipFit" value="true"
                   autocomplete="off"> On
          </label>
        </div>
    </div>
    <div class="form-group" style="display:none">
        <label for="hts-dip-type">Vertical axis</label>
        <div class="hts-dip-type btn-group btn-group-2 btn-group-responsive"
             data-toggle="buttons">
          <label class="btn btn-default active">
            <input type="radio" name="dipType" value="rel"
                   autocomplete="off" checked> Relative
          </label>
          <label class="btn btn-default">
            <input type="radio" name="dipType" value="abs"
                   autocomplete="off"> Absolute
          </label>
        </div>
    </div>
    </div>
</div>
<div class="row">
    <div class="col-sm-12">
    <button type="submit" class="btn btn-success
        form-control">Show Plot</button>
    </div>
</div>
</form>
</div>
<div class="plotly-graph-div" style="width:100%; height:100%"></div>

        </div>
    </div>
</div>

<div id="change-dataset-modal" class="modal fade" role="dialog" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content">
        <div class="modal-body">
            {% with close_modal_btn=True %}
{% include "dataset_table.html" %}
            {% endwith %}
        </div>
    </div>
  </div>
</div>


{% endblock %}

{% block tailscript %}
{% load webpack_loader %}
{% render_bundle 'plots' 'js' %}
<script>
$(function () {
    pyHTS.views.plots.activate();
});
</script>
{% endblock %}
