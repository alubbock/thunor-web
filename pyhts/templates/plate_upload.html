{% extends "base.html" %}

{% block title %}{% if dataset %}Add to Dataset{% else %}Create Dataset{% endif %}{% endblock %}

{% block content %}
{# Plate File Upload #}
<div class="row">
    <div>
        <div class="container">
            {% if not dataset %}
            <div id="hts-dataset-upload-1" class="panel panel-default">
                <div class="panel-heading">
                    <span class="h3">Specify Details</span>
                    <button id="hts-next-1" type="button" class="btn
                    btn-success pull-right">Next
                          <span class="fa fa-arrow-right"
                                aria-hidden="true"></span>
                    </button>
                </div>
                <div class="panel-body">
                    <label for="dataset-name">Dataset Name</label>
                    <input type="text" name="dataset-name"
                           class="form-control" />
                </div>
            </div>
            {% endif %}

            <div id="hts-dataset-upload-2"
                 style="{% if not dataset %}display:none{% endif %}"
                 class="panel
                 panel-default">
                <div class="panel-heading inline-headers clearfix">
                    <span class="h3">Upload Plates</span>
                    <a id="hts-next-2" role="button" class="btn
                    btn-success pull-right" href="{% if dataset %}{% url 'pyhts:plate_designer' dataset.id %}{% else %}#{% endif %}">Next
                          <span class="fa fa-arrow-right"
                                aria-hidden="true"></span>
                    </a>
                    <div class="clearfix"></div>
                </div>
                <div class="panel-body">
                    <h4>Select files from your computer <small>
                        Drag and drop or click
                        <strong>Browse</strong></small></h4>
                    <input type="hidden" name="dataset-id" value="">
                    <input type="file" name="file_field[]"
                           id="js-upload-files" multiple
                           class="file-loading">
                    <div id="errorBlock" class="help-block"></div>

                </div>
            </div>

        </div> <!-- /container -->
    </div>
</div>
{% endblock %}

{% block tailscript %}
<script>
$(function () {
    'use strict';
    var initialPreview = [], initialPreviewConfig = [];
    {% for pf in plate_files %}
        initialPreview.push('{% spaceless %}
        {% include "ajax_upload_template.html" with plate_file_format=pf.file_format %}
        {% endspaceless %}');
        initialPreviewConfig.push({caption: '{{ pf.file.name|escapejs }}',
            key:{{ pf.id }}});
    {% endfor %}

    $.extend(pyHTS.state, {
        initialPreview: initialPreview,
        initialPreviewConfig: initialPreviewConfig,
        datasetId: {% if dataset %}{{ dataset.id }}{% else %}null{% endif %}
    });

    pyHTS.views.plate_upload.activate();

});
</script>
{% endblock %}
